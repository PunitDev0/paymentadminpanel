import{n as V,r as i,j as e,X as ee,M as ae,y as te,g as _,I as se,J as re}from"./app-Cue28fQB.js";import{S as ne}from"./search-hqa4OiQA.js";import{R as le}from"./rotate-ccw-uRXTR3Dr.js";import{F as oe}from"./file-text-BcRKlefK.js";/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],ce=V("Save",ie);/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],me=V("UserPlus",de),be=()=>{const[k,q]=i.useState([]),[c,E]=i.useState(""),[S,C]=i.useState({}),[N,H]=i.useState([]),[h,$]=i.useState(""),[b,M]=i.useState(""),[p,P]=i.useState(""),[f,R]=i.useState(""),[y,I]=i.useState(""),[z,A]=i.useState(!1),[F,L]=i.useState(null),[U,w]=i.useState(null),[l,T]=i.useState({}),[t,D]=i.useState({role:"",name:"",email:"",company:"",pancard_number:"",aadhaar_number:"",mobile:"",address:"",state:"",city:"",pincode:"",otp_verifaction:0});i.useEffect(()=>{(async()=>{try{const n=(await te()).map(s=>s.name);console.log("Fetched roles:",n),q(n),n.length>0&&(E(n[0]),D(s=>({...s,role:n[0]})));const o=await _();if(C(o),n.length>0){const s=`${n[0]}s`;j(n[0],o[s]||[],h,b,p,f,y)}}catch(r){console.error("Error fetching data:",r),w("Failed to fetch data: "+r.message)}})()},[]);const O=a=>{E(a);const r=`${a}s`;j(a,S[r]||[],h,b,p,f,y)},j=(a,r,n,o,s,u,v)=>{let m=[...r||[]];if(n&&(m=m.filter(x=>x.name.toLowerCase().includes(n.toLowerCase())||x.email.toLowerCase().includes(n.toLowerCase()))),o&&s){const x=new Date(o),B=new Date(s);B.setHours(23,59,59,999),m=m.filter(Y=>{const K=new Date(Y.created_at);return K>=x&&K<=B})}u&&(m=m.filter(x=>x.company===u)),v&&(m=m.filter(x=>x.status===v)),H(m)},G=()=>{const a=`${c}s`;j(c,S[a]||[],h,b,p,f,y)},Z=()=>{$(""),M(""),P(""),R(""),I("");const a=`${c}s`;j(c,S[a]||[],"","","","","")},g=a=>`"${String(a).replace(/"/g,'""')}"`,J=()=>{const a=[["#","Name","Email","Mobile","Company","Pancard","Aadhaar","Created At"],...N.map((s,u)=>[u+1,g(s.name||"N/A"),g(s.email||"N/A"),g(s.mobile||"N/A"),g(s.company||"N/A"),g(s.pancard_number||"N/A"),g(s.aadhaar_number||"N/A"),g(new Date(s.created_at).toLocaleDateString())])].map(s=>s.join(",")).join(`
`),r=new Blob([a],{type:"text/csv"}),n=window.URL.createObjectURL(r),o=document.createElement("a");o.href=n,o.download=`member_details_${c.toLowerCase()}.csv`,o.click(),window.URL.revokeObjectURL(n)},X=async a=>{if(window.confirm("Are you sure you want to deactivate this member?"))try{await re(a);const r=await _();C(r);const n=`${c}s`;j(c,r[n]||[],h,b,p,f,y),alert("Member deactivated successfully.")}catch(r){w("Failed to deactivate member: "+r.message)}},Q=()=>{const a={};return t.name||(a.name="Name is required"),t.email?/\S+@\S+\.\S+/.test(t.email)||(a.email="Invalid email format"):a.email="Email is required",t.mobile&&!/^\d{10}$/.test(t.mobile)&&(a.mobile="Mobile must be 10 digits"),t.pancard_number&&!/^[A-Z]{5}[0-9]{4}[A-Z]{1}$/.test(t.pancard_number)&&(a.pancard_number="Invalid PAN format"),t.aadhaar_number&&!/^\d{12}$/.test(t.aadhaar_number)&&(a.aadhaar_number="Aadhaar must be 12 digits"),t.pincode&&!/^\d{6}$/.test(t.pincode)&&(a.pincode="Pincode must be 6 digits"),a},d=a=>{const{name:r,value:n}=a.target;D(o=>({...o,[r]:n})),T(o=>({...o,[r]:""}))},W=async a=>{var n,o;a.preventDefault(),w(null),L(null);const r=Q();if(Object.keys(r).length>0){T(r);return}console.log("Form Data being sent:",t);try{const s=await se(t),u=await _();C(u);const v=`${c}s`;j(c,u[v]||[],h,b,p,f,y),s.generated_password&&L(s.generated_password),D({role:k[0]||"",name:"",email:"",company:"",pancard_number:"",aadhaar_number:"",mobile:"",address:"",state:"",city:"",pincode:"",otp_verifaction:0}),A(!1),alert("User added successfully.")}catch(s){w("Failed to add user: "+(((o=(n=s.response)==null?void 0:n.data)==null?void 0:o.error)||s.message))}};return z?e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto p-4 sm:p-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Create User"}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4 border-b pb-2",children:"Member Information"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Role"}),e.jsx("select",{name:"role",value:t.role,onChange:d,className:`mt-1 block w-full border ${l.role?"border-red-500":"border-gray-200"} rounded-lg p-2 bg-white text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500`,"aria-label":"Select role",children:k.map(a=>e.jsx("option",{value:a,children:a.charAt(0).toUpperCase()+a.slice(1)},a))}),l.role&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:l.role})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),e.jsx("input",{type:"text",name:"name",value:t.name,onChange:d,className:`mt-1 block w-full border ${l.name?"border-red-500":"border-gray-200"} rounded-lg p-2 bg-white text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500`,placeholder:"Enter name",required:!0,"aria-label":"Member name"}),l.name&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:l.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsx("input",{type:"email",name:"email",value:t.email,onChange:d,className:`mt-1 block w-full border ${l.email?"border-red-500":"border-gray-200"} rounded-lg p-2 bg-white text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500`,placeholder:"Enter email",required:!0,"aria-label":"Member email"}),l.email&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:l.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Company"}),e.jsxs("select",{name:"company",value:t.company,onChange:d,className:"mt-1 block w-full border border-gray-200 rounded-lg p-2 bg-white text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500","aria-label":"Select company",children:[e.jsx("option",{value:"",children:"Select Company"}),e.jsx("option",{value:"Banking NIKAT-By",children:"Banking NIKAT-By"})]})]})]}),e.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4 border-b pb-2",children:"Business Information"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Pancard Number"}),e.jsx("input",{type:"text",name:"pancard_number",value:t.pancard_number,onChange:d,className:`mt-1 block w-full border ${l.pancard_number?"border-red-500":"border-gray-200"} rounded-lg p-2 bg-white text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500`,placeholder:"Enter PAN number","aria-label":"Pancard number"}),l.pancard_number&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:l.pancard_number})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Aadhaarcard Number"}),e.jsx("input",{type:"text",name:"aadhaar_number",value:t.aadhaar_number,onChange:d,className:`mt-1 block w-full border ${l.aadhaar_number?"border-red-500":"border-gray-200"} rounded-lg p-2 bg-white text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500`,placeholder:"Enter Aadhaar number","aria-label":"Aadhaarcard number"}),l.aadhaar_number&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:l.aadhaar_number})]})]}),e.jsx("h2",{className:"text-lg font-semibold text-gray-800 mb-4 border-b pb-2",children:"Personal Information"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Mobile"}),e.jsx("input",{type:"text",name:"mobile",value:t.mobile,onChange:d,className:`mt-1 block w-full border ${l.mobile?"border-red-500":"border-gray-200"} rounded-lg p-2 bg-white text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500`,placeholder:"Enter mobile number","aria-label":"Mobile number"}),l.mobile&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:l.mobile})]}),e.jsxs("div",{className:"sm:col-span-2 lg:col-span-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Address"}),e.jsx("input",{type:"text",name:"address",value:t.address,onChange:d,className:"mt-1 block w-full border border-gray-200 rounded-lg p-2 bg-white text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"Enter address","aria-label":"Address"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"State"}),e.jsx("input",{type:"text",name:"state",value:t.state,onChange:d,className:"mt-1 block w-full border border-gray-200 rounded-lg p-2 bg-white text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"Enter state","aria-label":"State"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"City"}),e.jsx("input",{type:"text",name:"city",value:t.city,onChange:d,className:"mt-1 block w-full border border-gray-200 rounded-lg p-2 bg-white text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500",placeholder:"Enter city","aria-label":"City"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Pincode"}),e.jsx("input",{type:"text",name:"pincode",value:t.pincode,onChange:d,className:`mt-1 block w-full border ${l.pincode?"border-red-500":"border-gray-200"} rounded-lg p-2 bg-white text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500`,placeholder:"Enter pincode","aria-label":"Pincode"}),l.pincode&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:l.pincode})]})]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsxs("button",{onClick:()=>A(!1),className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 transition-colors duration-200","aria-label":"Cancel form",children:[e.jsx(ee,{className:"h-4 w-4 inline mr-1"})," Cancel"]}),e.jsxs("button",{onClick:W,className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-colors duration-200","aria-label":"Submit form",children:[e.jsx(ce,{className:"h-4 w-4 inline mr-1"})," Submit"]})]}),F&&e.jsxs("div",{className:"mt-4 p-4 bg-green-100 text-green-700 rounded-lg",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Generated Password:"})," ",F]}),e.jsx("p",{children:"Please save this password securely. It will be needed for login."}),e.jsx("p",{children:"An email with the credentials has been sent to the user."})]}),U&&e.jsx("div",{className:"mt-4 p-4 bg-red-100 text-red-700 rounded-lg",children:e.jsxs("p",{children:[e.jsx("strong",{children:"Error:"})," ",U]})})]})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto p-4 sm:p-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Member Details"}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[e.jsx("div",{className:"flex border-b border-gray-200",children:k.map(a=>e.jsx("button",{onClick:()=>O(a),className:`px-4 py-2 text-sm font-medium ${c===a?"bg-white text-indigo-600 border-b-2 border-indigo-600":"text-gray-600 hover:bg-gray-50"} transition-colors duration-200`,"aria-label":`View ${a} members`,children:a.charAt(0).toUpperCase()+a.slice(1)},a))}),e.jsx("div",{className:"p-4 sm:p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-3",children:[e.jsx("input",{type:"date",value:b,onChange:a=>M(a.target.value),className:"p-2 border border-gray-200 rounded-lg bg-white text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500","aria-label":"From date"}),e.jsx("input",{type:"date",value:p,onChange:a=>P(a.target.value),className:"p-2 border border-gray-200 rounded-lg bg-white text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500","aria-label":"To date"}),e.jsx("input",{type:"text",value:h,onChange:a=>$(a.target.value),placeholder:"Search by name or email",className:"p-2 border border-gray-200 rounded-lg bg-white text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500","aria-label":"Search members"}),e.jsx("input",{type:"text",placeholder:"Agent ID / Parent ID",className:"p-2 border border-gray-200 rounded-lg bg-white text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500","aria-label":"Agent ID or Parent ID"}),e.jsxs("select",{value:y,onChange:a=>I(a.target.value),className:"p-2 border border-gray-200 rounded-lg bg-white text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500","aria-label":"Select status",children:[e.jsx("option",{value:"",children:"Select Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"deactive",children:"Deactive"})]}),e.jsxs("select",{value:f,onChange:a=>R(a.target.value),className:"p-2 border border-gray-200 rounded-lg bg-white text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500","aria-label":"Select company",children:[e.jsx("option",{value:"",children:"Select Company"}),e.jsx("option",{value:"Banking NIKAT-By",children:"Banking NIKAT-By"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:G,className:"p-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-colors duration-200","aria-label":"Search members",children:e.jsx(ne,{className:"h-4 w-4"})}),e.jsx("button",{onClick:Z,className:"p-2 bg-red-600 text-white rounded-lg hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 transition-colors duration-200","aria-label":"Reset filters",children:e.jsx(le,{className:"h-4 w-4"})}),e.jsx("button",{onClick:J,className:"p-2 bg-green-600 text-white rounded-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 transition-colors duration-200","aria-label":"Export data as CSV",children:e.jsx(oe,{className:"h-4 w-4"})})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md mt-6 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-800",children:[c.charAt(0).toUpperCase()+c.slice(1)," List"]}),e.jsxs("button",{onClick:()=>A(!0),className:"px-4 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-colors duration-200","aria-label":"Add new user",children:[e.jsx(me,{className:"h-4 w-4 inline mr-1"})," Add User"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-100 sticky top-0",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider",children:"#"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider",children:"Name"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider",children:"Email"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider",children:"Mobile"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider",children:"Company"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider",children:"Pancard"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider",children:"Aadhaar"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider",children:"Created At"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:N.length>0?N.map((a,r)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:r+1}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:a.name||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:a.email||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:a.mobile||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:a.company||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:a.pancard_number||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:a.aadhaar_number||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(a.created_at).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.jsxs("div",{className:"relative inline-block text-left",children:[e.jsx("button",{className:"p-2 bg-gray-100 rounded-lg hover:bg-gray-200 focus:outline-none focus:ring-2 focus:ring-indigo-500","aria-label":`Actions for ${a.name}`,children:e.jsx(ae,{className:"h-4 w-4 text-gray-600"})}),e.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg z-10 hidden group-hover:block",children:e.jsxs("div",{className:"py-1",children:[e.jsx("button",{className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100",onClick:()=>alert("View Reports for "+a.name),children:"Reports"}),c!=="deactivated"&&e.jsx("button",{className:"w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-gray-100",onClick:()=>X(a.id),children:"Deactivate"})]})})]})})]},a.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"9",className:"px-6 py-4 text-center text-sm text-gray-500",children:"No Data Available in Table"})})})]})}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-between mt-4 gap-4",children:[e.jsxs("p",{className:"text-sm text-gray-500",children:["Showing ",N.length," of ",N.length," entries"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"px-3 py-1 bg-gray-200 rounded-lg hover:bg-gray-300 disabled:bg-gray-100",disabled:!0,children:"Previous"}),e.jsx("span",{className:"px-3 py-1 bg-indigo-600 text-white rounded-lg",children:"1"}),e.jsx("button",{className:"px-3 py-1 bg-gray-200 rounded-lg hover:bg-gray-300 disabled:bg-gray-100",disabled:!0,children:"Next"}),e.jsxs("select",{className:"p-2 border border-gray-200 rounded-lg bg-white text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500","aria-label":"Select page size",children:[e.jsx("option",{children:"Show 10"}),e.jsx("option",{children:"Show 25"}),e.jsx("option",{children:"Show 50"})]})]})]})]})]})})};export{be as default};
