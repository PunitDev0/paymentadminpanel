import{r as x,j as e,i as O,k as v}from"./app-CwTA4m8q.js";const y=[{id:"all",title:"All Commissions"},{id:"recharge",title:"Recharge"},{id:"electricity",title:"Electricity"},{id:"digital_voucher",title:"Digital Voucher"},{id:"datacard",title:"Datacard"},{id:"gas_fastag",title:"Gas & Fastag"},{id:"cms",title:"CMS"},{id:"challan",title:"Challan"},{id:"cable",title:"Cable"},{id:"broadband",title:"Broadband"},{id:"bank",title:"Bank"}],M=()=>{const[b,h]=x.useState({recharge_commissions:[],electricity_commissions:[],digital_voucher_commissions:[],datacard_commissions:[],gas_fastag_commissions:[],cms_commissions:[],challan_commissions:[],cable_commissions:[],broadband_commissions:[],bank_commissions:[]}),[g,f]=x.useState({}),[w,k]=x.useState("recharge"),[_,S]=x.useState({recharge_commissions:"",electricity_commissions:"",digital_voucher_commissions:"",datacard_commissions:"",gas_fastag_commissions:"",cms_commissions:"",challan_commissions:"",cable_commissions:"",broadband_commissions:"",bank_commissions:""});x.useEffect(()=>{(async()=>{try{const r=await O();h(r)}catch(r){console.error("Failed to fetch commissions:",r),h({recharge_commissions:[],electricity_commissions:[],digital_voucher_commissions:[],datacard_commissions:[],gas_fastag_commissions:[],cms_commissions:[],challan_commissions:[],cable_commissions:[],broadband_commissions:[],bank_commissions:[]})}})()},[]);const m=(a,r,s)=>{const i=r===""?0:parseFloat(r)||0;h(o=>{const n={...o},t=n[s].findIndex(c=>c.id===a);return t!==-1&&(n[s][t]={...n[s][t],our_commission:i},f(c=>{const l={...c};l[s]||(l[s]=[]);const d=l[s].findIndex(u=>u.id===a);return d!==-1?l[s][d]={id:a,our_commission:i}:l[s].push({id:a,our_commission:i}),l})),n})},F=async()=>{if(Object.keys(g).length===0){alert("No changes to save.");return}try{await v(g),alert("Commissions updated successfully!"),f({})}catch(a){alert("Failed to update commissions: "+a.message)}},p=async(a,r)=>{var i;const s=(i=g[r])==null?void 0:i.find(o=>o.id===a);if(!s){alert("No changes to save for this row.");return}try{await v({[r]:[s]}),f(o=>{const n={...o};return n[r]=n[r].filter(t=>t.id!==a),n[r].length===0&&delete n[r],n}),alert("Commission updated successfully!")}catch(o){alert("Failed to update commission: "+o.message)}},L=(a,r)=>{S(s=>({...s,[a]:r}))},A=(a,r)=>{const s=_[r].toLowerCase();return s?a.filter(i=>{var o,n,t,c,l,d,u,j,N,C;return r==="bank_commissions"?((o=i.transaction_amount)==null?void 0:o.toString().toLowerCase().includes(s))||((n=i.category)==null?void 0:n.toLowerCase().includes(s)):r==="cms_commissions"?((t=i.operator_id)==null?void 0:t.toLowerCase().includes(s))||((c=i.operator_name)==null?void 0:c.toLowerCase().includes(s))||((l=i.type)==null?void 0:l.toLowerCase().includes(s)):["gas_fastag_commissions","broadband_commissions"].includes(r)?((d=i.operator_name)==null?void 0:d.toLowerCase().includes(s))||((u=i.category)==null?void 0:u.toLowerCase().includes(s))||((j=i.type)==null?void 0:j.toLowerCase().includes(s)):((N=i.operator_name)==null?void 0:N.toLowerCase().includes(s))||((C=i.type)==null?void 0:C.toLowerCase().includes(s))}):a},D=()=>{var r;const a=w==="all"?Object.keys(b):[((r=y.find(s=>s.id===w))==null?void 0:r.id)+"_commissions"];return e.jsxs("div",{className:"mt-6 space-y-8",children:[a.map(s=>{const i=b[s]||[],o=A(i,s);if(!o.length)return null;const n=y.find(t=>t.id+"_commissions"===s);return n?e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4",children:[n.title," Commissions"]}),e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:`Search ${n.title}...`,value:_[s],onChange:t=>L(s,t.target.value),className:"w-full sm:w-64 p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[["recharge_commissions","electricity_commissions","digital_voucher_commissions","datacard_commissions","challan_commissions","cable_commissions"].includes(s)&&e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Operator Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Commission"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Our Commission"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Action"})]}),["gas_fastag_commissions","broadband_commissions"].includes(s)&&e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Operator Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Commission"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Our Commission"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Action"})]}),s==="cms_commissions"&&e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Agent ID"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Agent Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Commission"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Our Commission"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Action"})]}),s==="bank_commissions"&&e.jsxs(e.Fragment,{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Transaction Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Commission"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Our Commission"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Action"})]})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[["recharge_commissions","electricity_commissions","digital_voucher_commissions","datacard_commissions","challan_commissions","cable_commissions"].includes(s)&&e.jsxs(e.Fragment,{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.operator_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.type}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.commission}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.jsx("input",{type:"number",min:"0",step:"0.01",value:t.our_commission,onChange:c=>m(t.id,c.target.value,s),className:"border rounded-lg p-2 w-20 focus:outline-none focus:ring-2 focus:ring-blue-500"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.jsx("button",{onClick:()=>p(t.id,s),className:"px-3 py-1 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Save"})})]}),["gas_fastag_commissions","broadband_commissions"].includes(s)&&e.jsxs(e.Fragment,{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.operator_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.category}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.type}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.commission}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.jsx("input",{type:"number",min:"0",step:"0.01",value:t.our_commission,onChange:c=>m(t.id,c.target.value,s),className:"border rounded-lg p-2 w-20 focus:outline-none focus:ring-2 focus:ring-blue-500"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.jsx("button",{onClick:()=>p(t.id,s),className:"px-3 py-1 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Save"})})]}),s==="cms_commissions"&&e.jsxs(e.Fragment,{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.operator_id}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.operator_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.type}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.commission}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.jsx("input",{type:"number",min:"0",step:"0.01",value:t.our_commission,onChange:c=>m(t.id,c.target.value,s),className:"border rounded-lg p-2 w-20 focus:outline-none focus:ring-2 focus:ring-blue-500"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.jsx("button",{onClick:()=>p(t.id,s),className:"px-3 py-1 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Save"})})]}),s==="bank_commissions"&&e.jsxs(e.Fragment,{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.transaction_amount}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.category}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:t.commission}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.jsx("input",{type:"number",min:"0",step:"0.01",value:t.our_commission,onChange:c=>m(t.id,c.target.value,s),className:"border rounded-lg p-2 w-20 focus:outline-none focus:ring-2 focus:ring-blue-500"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.jsx("button",{onClick:()=>p(t.id,s),className:"px-3 py-1 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Save"})})]})]},t.id))})]})})]},s):null}),a.length>0&&e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx("button",{onClick:F,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 shadow-md",children:"Save All Changes"})})]})};return e.jsx("div",{className:"p-6 bg-gray-50 min-h-screen",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-6",children:"Commission Manager"}),e.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 mb-6",children:e.jsx("select",{value:w,onChange:a=>k(a.target.value),className:"w-full sm:w-64 p-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:y.map(a=>e.jsx("option",{value:a.id,children:a.title},a.id))})}),D()]})})};export{M as default};
