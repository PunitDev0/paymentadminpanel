var D=Object.defineProperty;var E=(a,t,r)=>t in a?D(a,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[t]=r;var v=(a,t,r)=>E(a,typeof t!="symbol"?t+"":t,r);import{j as e,z as F,r as c,a as R,A as k}from"./app-DGzTNTrR.js";import{T,a as A,b as _,c as l,d as L,e as n}from"./table-kNFp5OBc.js";import{c as m}from"./utils-CiMRq3MP.js";import{b as q,B as w}from"./button-DFkykpdv.js";import{C as U}from"./chevron-left-Q0njvbQV.js";import{I as j}from"./input-CpSZEQX0.js";import{S as B,a as z,b as V,c as G,d as S}from"./select-CPd7MAFz.js";import{S as H}from"./search-DYKDklTV.js";import{F as M}from"./filter-uui1nXHK.js";import"./clsx-B-dksMZM.js";import"./index-Fjn0H5Tz.js";import"./index-BFgNMtlU.js";import"./index-D8gUoIIn.js";import"./check-DXUP-ycH.js";function J({className:a,...t}){return e.jsx("nav",{role:"navigation","aria-label":"pagination","data-slot":"pagination",className:m("mx-auto flex w-full justify-center",a),...t})}function K({className:a,...t}){return e.jsx("ul",{"data-slot":"pagination-content",className:m("flex flex-row items-center gap-1",a),...t})}function f({...a}){return e.jsx("li",{"data-slot":"pagination-item",...a})}function C({className:a,isActive:t,size:r="icon",...o}){return e.jsx("a",{"aria-current":t?"page":void 0,"data-slot":"pagination-link","data-active":t,className:m(q({variant:t?"outline":"ghost",size:r}),a),...o})}function O({className:a,...t}){return e.jsxs(C,{"aria-label":"Go to previous page",size:"default",className:m("gap-1 px-2.5 sm:pl-2.5",a),...t,children:[e.jsx(U,{}),e.jsx("span",{className:"hidden sm:block",children:"Previous"})]})}function Q({className:a,...t}){return e.jsxs(C,{"aria-label":"Go to next page",size:"default",className:m("gap-1 px-2.5 sm:pr-2.5",a),...t,children:[e.jsx("span",{className:"hidden sm:block",children:"Next"}),e.jsx(F,{})]})}class W extends k.Component{constructor(){super(...arguments);v(this,"state",{hasError:!1,error:null})}static getDerivedStateFromError(r){return{hasError:!0,error:r}}render(){var r;return this.state.hasError?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsxs("p",{className:"text-lg text-red-500",children:["Something went wrong: ",((r=this.state.error)==null?void 0:r.message)||"Unknown error"]})}):this.props.children}}const oe=()=>{const[a,t]=c.useState([]),[r,o]=c.useState({current_page:1,last_page:1,per_page:10,total:0}),[h,N]=c.useState(!0),[d,p]=c.useState(null),[x,I]=c.useState({search:"",status:"",api_name:"",user_id:"",id:""}),b=async(s=1,u={})=>{N(!0);try{const i=await R.get("/admin/api-logs",{params:{page:s,per_page:r.per_page,...u}});i.data.success?(t(i.data.data),o(i.data.pagination),p(null)):p("Failed to fetch records")}catch{p("Failed to fetch records")}finally{N(!1)}};c.useEffect(()=>{b(1,x)},[x]);const y=s=>{s>=1&&s<=r.last_page&&b(s,x)},g=(s,u)=>{I(i=>({...i,[s]:u})),o(i=>({...i,current_page:1}))};[...new Set(a.map(s=>s.api_name))].filter(s=>s&&s.trim()!=="");const P=["success","failed"];return e.jsx(W,{children:e.jsxs("div",{className:"container mx-auto p-4 sm:p-6 lg:p-8 bg-gray-50 min-h-screen",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold mb-6 text-gray-800",children:"API Logs Dashboard"}),e.jsxs("div",{className:"mb-6 flex flex-col sm:flex-row gap-4 sm:items-center flex-wrap",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(H,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),e.jsx(j,{placeholder:"Search by Request ID or Reference ID...",value:x.search,onChange:s=>g("search",s.target.value),className:"pl-10 py-2 bg-white border-gray-200 focus:ring-indigo-500 focus:border-indigo-500"})]}),e.jsxs("div",{className:"flex gap-4 flex-wrap",children:[e.jsx("div",{className:"relative w-[120px]",children:e.jsx(j,{placeholder:"Filter ID",value:x.id,onChange:s=>g("id",s.target.value),className:"py-2 bg-white border-gray-200 focus:ring-indigo-500 focus:border-indigo-500"})}),e.jsx("div",{className:"relative w-[120px]",children:e.jsx(j,{placeholder:"Filter User ID",value:x.user_id,onChange:s=>g("user_id",s.target.value),className:"py-2 bg-white border-gray-200 focus:ring-indigo-500 focus:border-indigo-500"})}),e.jsxs(B,{value:x.status,onValueChange:s=>g("status",s==="all"?null:s),children:[e.jsxs(z,{className:"w-[150px] bg-white border-gray-200",children:[e.jsx(M,{className:"h-5 w-5 text-gray-400 mr-2"}),e.jsx(V,{placeholder:"Filter Status"})]}),e.jsxs(G,{children:[e.jsx(S,{value:"all",children:"All Statuses"}),P.map(s=>e.jsx(S,{value:s,children:s.charAt(0).toUpperCase()+s.slice(1)},s))]})]})]})]}),h&&e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("p",{className:"text-lg text-gray-500 animate-pulse",children:"Loading..."})}),d&&e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("p",{className:"text-lg text-red-500",children:d})}),!h&&!d&&e.jsx("div",{className:"overflow-x-auto border rounded-lg shadow-sm bg-white",children:e.jsxs(T,{children:[e.jsx(A,{children:e.jsxs(_,{className:"bg-gray-100",children:[e.jsx(l,{className:"text-xs sm:text-sm font-semibold text-gray-700",children:"ID"}),e.jsx(l,{className:"text-xs sm:text-sm font-semibold text-gray-700",children:"User ID"}),e.jsx(l,{className:"text-xs sm:text-sm font-semibold text-gray-700",children:"API Name"}),e.jsx(l,{className:"text-xs sm:text-sm font-semibold text-gray-700",children:"Request ID"}),e.jsx(l,{className:"text-xs sm:text-sm font-semibold text-gray-700",children:"Reference ID"}),e.jsx(l,{className:"text-xs sm:text-sm font-semibold text-gray-700",children:"Request Payload"}),e.jsx(l,{className:"text-xs sm:text-sm font-semibold text-gray-700",children:"Response Data"}),e.jsx(l,{className:"text-xs sm:text-sm font-semibold text-gray-700",children:"Status"}),e.jsx(l,{className:"text-xs sm:text-sm font-semibold text-gray-700",children:"Error Message"}),e.jsx(l,{className:"text-xs sm:text-sm font-semibold text-gray-700",children:"IP Address"}),e.jsx(l,{className:"text-xs sm:text-sm font-semibold text-gray-700",children:"Execution Time"}),e.jsx(l,{className:"text-xs sm:text-sm font-semibold text-gray-700",children:"Created At"}),e.jsx(l,{className:"text-xs sm:text-sm font-semibold text-gray-700",children:"Updated At"})]})}),e.jsx(L,{children:a.map(s=>e.jsxs(_,{className:"hover:bg-gray-50",children:[e.jsx(n,{className:"text-xs sm:text-sm",children:s.id}),e.jsx(n,{className:"text-xs sm:text-sm",children:s.user_id||"-"}),e.jsx(n,{className:"text-xs sm:text-sm",children:s.api_name}),e.jsx(n,{className:"text-xs sm:text-sm",children:s.request_id}),e.jsx(n,{className:"text-xs sm:text-sm",children:s.reference_id}),e.jsx(n,{className:"max-w-[150px] sm:max-w-[200px] truncate break-all text-xs sm:text-sm",children:s.request_payload}),e.jsx(n,{className:"max-w-[150px] sm:max-w-[200px] truncate break-all text-xs sm:text-sm",children:s.response_data}),e.jsx(n,{className:"text-xs sm:text-sm",children:s.status}),e.jsx(n,{className:"text-xs sm:text-sm",children:s.error_message||"-"}),e.jsx(n,{className:"text-xs sm:text-sm",children:s.ip_address||"-"}),e.jsx(n,{className:"text-xs sm:text-sm",children:s.execution_time||"-"}),e.jsx(n,{className:"text-xs sm:text-sm",children:s.created_at}),e.jsx(n,{className:"text-xs sm:text-sm",children:s.updated_at})]},s.id))})]})}),!h&&!d&&e.jsx(J,{className:"mt-6 justify-center",children:e.jsxs(K,{children:[e.jsx(f,{children:e.jsx(w,{variant:"outline",className:"border-gray-200 hover:bg-indigo-50",onClick:()=>y(r.current_page-1),disabled:r.current_page===1,children:e.jsx(O,{})})}),e.jsx(f,{children:e.jsxs("span",{className:"text-sm px-4 py-2 text-gray-600",children:["Page ",r.current_page," of ",r.last_page]})}),e.jsx(f,{children:e.jsx(w,{variant:"outline",className:"border-gray-200 hover:bg-indigo-50",onClick:()=>y(r.current_page+1),disabled:r.current_page===r.last_page,children:e.jsx(Q,{})})})]})})]})})};export{oe as default};
