import{r as c,j as e,w as F,x as k,y as I}from"./app-BhIvF-2x.js";import{u as L,F as M,a as j,b as d,c as i,d as f,e as m,f as x,g as P,h as U,i as T,j as $,D as B,k as H,l as v,m as q,n as G,o as O,p as _,y as o}from"./index-MFnCnay8.js";import{C as z,a as J,b as K,c as Q}from"./card-CBxig8zB.js";import{B as h}from"./button-DqwfdkFe.js";import{I as u}from"./input-BZekdRNK.js";import{S as W,a as X,b as Y,c as Z,d as ee}from"./select-DDGTz6sR.js";import"./index-3fh5wBpP.js";import"./index-CrueKese.js";import"./utils-CiMRq3MP.js";import"./clsx-B-dksMZM.js";import"./index-CIbWgBxM.js";import"./check-BVEHZVcu.js";function se({id:t}){const[N,w]=c.useState(!1),[g,p]=c.useState(""),[y,ae]=c.useState(["admin","user"]),[b,S]=c.useState(null);console.log(y);const r=L({defaultValues:{name:"",email:"",role:"",password:""}});c.useEffect(()=>{t&&(async()=>{try{const a=await F(t);S(a),r.reset({name:a.name||"",email:a.email||"",role:a.role||"",password:""})}catch(a){console.error("Error fetching user data:",a),o.error("Failed to fetch user data")}})()},[t,r]);const C=s=>{if(!s)return"";const a=Math.random().toString(36).slice(-4),n=Math.floor(1e3+Math.random()*9e3);return`${s.replace(/\s+/g,"").toLowerCase()}@${a}${n}`},D=s=>{const a=s.target.value;r.setValue("name",a),t||r.setValue("password",C(a))},E=()=>{const s=r.getValues("name");r.setValue("password",C(s))},R=async s=>{var a,n;w(!0);try{if(t){const l={...s};l.password||delete l.password;const V=await F(t,l);console.log("Updated user data:",V),o.success("User updated successfully")}else{const l=await k(s);console.log("Created new user:",l),o.success("User added successfully")}r.reset()}catch(l){console.error("Error submitting form:",l),o.error(`Error: ${((n=(a=l.response)==null?void 0:a.data)==null?void 0:n.message)||"Failed to process request"}`)}finally{w(!1)}},A=async()=>{if(g.trim())try{await I(g),o.success("Role added successfully"),p("")}catch(s){console.error("Error adding role:",s),o.error("Failed to add role")}};return e.jsx("div",{className:"h-[90vh] flex items-center justify-center bg-gray-50",children:e.jsxs(z,{className:"w-full max-w-2xl mx-auto shadow-lg rounded-lg bg-white",children:[e.jsx(J,{children:e.jsx(K,{className:"text-2xl font-bold text-gray-800",children:t?"Update User":"Add New User"})}),e.jsx(Q,{children:e.jsx(M,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(R),className:"space-y-6",children:[e.jsx(j,{control:r.control,name:"name",render:({field:s})=>e.jsxs(d,{className:"flex items-center space-x-3",children:[e.jsxs(i,{className:"flex items-center text-gray-600",children:[e.jsx(f,{className:"mr-2 text-blue-500"})," Name"]}),e.jsx(m,{children:e.jsx(u,{...s,onChange:D,placeholder:"Enter name"})}),e.jsx(x,{})]})}),e.jsx(j,{control:r.control,name:"email",render:({field:s})=>e.jsxs(d,{className:"flex items-center space-x-3",children:[e.jsxs(i,{className:"flex items-center text-gray-600",children:[e.jsx(P,{className:"mr-2 text-blue-500"})," Email"]}),e.jsx(m,{children:e.jsx(u,{...s,type:"email",placeholder:"Enter email"})}),e.jsx(x,{})]})}),b&&e.jsxs(d,{className:"flex items-center space-x-3",children:[e.jsxs(i,{className:"flex items-center text-gray-600",children:[e.jsx(U,{className:"mr-2 text-blue-500"})," Current Role"]}),e.jsx(m,{children:e.jsx(u,{readOnly:!0,value:b.role})}),e.jsx(x,{})]}),e.jsx(j,{control:r.control,name:"role",render:({field:s})=>e.jsxs(d,{className:"flex items-center space-x-3",children:[e.jsxs(i,{className:"flex items-center text-gray-600",children:[e.jsx(U,{className:"mr-2 text-blue-500"})," Role"]}),e.jsxs(W,{onValueChange:s.onChange,value:s.value,children:[e.jsx(m,{children:e.jsx(X,{children:e.jsx(Y,{placeholder:"Select a role"})})}),e.jsx(Z,{children:y.map((a,n)=>e.jsx(ee,{value:a,children:a},n))})]}),e.jsx(x,{})]})}),e.jsx(j,{control:r.control,name:"password",render:({field:s})=>e.jsxs(d,{className:"flex items-center space-x-3",children:[e.jsxs(i,{className:"flex items-center text-gray-600",children:[e.jsx(T,{className:"mr-2 text-blue-500"})," Password"]}),e.jsx(m,{children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(u,{...s,placeholder:t?"Enter new password (optional)":"Generated password"}),e.jsxs(h,{type:"button",onClick:E,className:"bg-gray-500 hover:bg-gray-600",children:[e.jsx($,{className:"mr-2"})," Regenerate"]})]})}),e.jsx(x,{})]})}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsxs(B,{children:[e.jsx(H,{asChild:!0,children:e.jsxs(h,{className:"bg-green-500 hover:bg-green-600 flex items-center",children:[e.jsx(v,{className:"mr-2"})," Add Role"]})}),e.jsxs(q,{children:[e.jsx(G,{children:e.jsx(O,{children:"Add New Role"})}),e.jsxs("div",{className:"p-4",children:[e.jsx(u,{value:g,onChange:s=>p(s.target.value),placeholder:"Enter new role"}),e.jsxs(_,{className:"mt-4",children:[e.jsxs(h,{onClick:A,className:"bg-green-500 hover:bg-green-600",children:[e.jsx(v,{className:"mr-2"})," Add Role"]}),e.jsx(h,{variant:"outline",onClick:()=>p(""),children:"Cancel"})]})]})]})]}),e.jsx(h,{type:"submit",className:"bg-[#7C3AED] hover:bg-[#6D28D9] flex items-center",disabled:N,children:N?e.jsxs(e.Fragment,{children:[e.jsx(f,{className:"animate-spin mr-2"})," ",t?"Updating...":"Adding..."]}):e.jsxs(e.Fragment,{children:[e.jsx(f,{className:"mr-2"})," ",t?"Update User":"Add User"]})})]})]})})})]})})}function je(){return e.jsx("div",{children:e.jsx(se,{})})}export{je as default};
