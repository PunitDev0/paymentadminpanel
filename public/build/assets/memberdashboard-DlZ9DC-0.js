import{v as z,r as c,j as e,S as O,G as Z,h as C,H as J,I as Q}from"./app-C1Adt5pp.js";import{R as W}from"./rotate-ccw-rjnOsKod.js";/**
 * @license lucide-react v0.479.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Y=z("FileText",X),te=()=>{const[N,P]=c.useState([]),[n,D]=c.useState(""),[f,v]=c.useState({}),[j,L]=c.useState([]),[m,S]=c.useState(""),[x,A]=c.useState(""),[h,_]=c.useState(""),[u,E]=c.useState(""),[T,w]=c.useState(!1),[R,F]=c.useState(null),[M,y]=c.useState(null),[d,k]=c.useState({role:"",name:"",email:"",company:"",pancard_number:"",aadhaar_number:"",mobile:"",address:"",state:"",city:"",pincode:"",otp_verifaction:0});c.useEffect(()=>{(async()=>{try{const t=(await Z()).map(r=>r.name);console.log("Fetched roles:",t),P(t),t.length>0&&(D(t[0]),k(r=>({...r,role:t[0]})));const l=await C();if(v(l),t.length>0){const r=`${t[0]}s`;p(t[0],l[r]||[],m,x,h,u)}}catch(s){console.error("Error fetching data:",s),y("Failed to fetch data: "+s.message)}})()},[]);const $=a=>{D(a);const s=`${a}s`;p(a,f[s]||[],m,x,h,u)},p=(a,s,t,l,r,b)=>{let i=[...s||[]];if(t&&(i=i.filter(g=>g.name.toLowerCase().includes(t.toLowerCase())||g.email.toLowerCase().includes(t.toLowerCase()))),l&&r){const g=new Date(l),V=new Date(r);V.setHours(23,59,59,999),i=i.filter(G=>{const I=new Date(G.created_at);return I>=g&&I<=V})}b&&(i=i.filter(g=>g.company===b)),L(i)},B=()=>{const a=`${n}s`;p(n,f[a]||[],m,x,h,u)},K=()=>{S(""),A(""),_(""),E("");const a=`${n}s`;p(n,f[a]||[],"","","","")},U=()=>{const a=[["#","Name","Company Profile","Action"],...j.map((r,b)=>[b+1,`${r.name}
${r.email}
${r.created_at}`,r.company||"N/A",""]),["#","Name","Company Profile","Action"]].map(r=>r.join(",")).join(`
`),s=new Blob([a],{type:"text/csv"}),t=window.URL.createObjectURL(s),l=document.createElement("a");l.href=t,l.download=`member_details_${n.toLowerCase()}.csv`,l.click(),window.URL.revokeObjectURL(t)},H=async a=>{if(window.confirm("Are you sure you want to deactivate this member?"))try{await Q(a);const s=await C();v(s);const t=`${n}s`;p(n,s[t]||[],m,x,h,u),alert("Member deactivated successfully.")}catch(s){y("Failed to deactivate member: "+s.message)}},o=a=>{const{name:s,value:t}=a.target;k(l=>({...l,[s]:t}))},q=async a=>{var s,t;a.preventDefault(),y(null),F(null),console.log("Form Data being sent:",d);try{const l=await J(d),r=await C();v(r);const b=`${n}s`;p(n,r[b]||[],m,x,h,u),l.generated_password&&F(l.generated_password),k({role:N[0]||"",name:"",email:"",company:"",pancard_number:"",aadhaar_number:"",mobile:"",address:"",state:"",city:"",pincode:"",otp_verifaction:0}),w(!1),alert("User added successfully.")}catch(l){y("Failed to add user: "+(((t=(s=l.response)==null?void 0:s.data)==null?void 0:t.error)||l.message))}};return T?e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Home - Create User"}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Member Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Role"}),e.jsx("select",{name:"role",value:d.role,onChange:o,className:"mt-1 block w-full border border-gray-300 rounded-md p-2",children:N.map(a=>e.jsx("option",{value:a,children:a.charAt(0).toUpperCase()+a.slice(1)},a))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Name"}),e.jsx("input",{type:"text",name:"name",value:d.name,onChange:o,className:"mt-1 block w-full border border-gray-300 rounded-md p-2",placeholder:"Enter Value",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsx("input",{type:"email",name:"email",value:d.email,onChange:o,className:"mt-1 block w-full border border-gray-300 rounded-md p-2",placeholder:"Enter Value",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Company"}),e.jsxs("select",{name:"company",value:d.company,onChange:o,className:"mt-1 block w-full border border-gray-300 rounded-md p-2",children:[e.jsx("option",{value:"",children:"Select Company"}),e.jsx("option",{value:"Banking NIKAT-By",children:"Banking NIKAT-By"})]})]})]}),e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Business Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Pancard Number"}),e.jsx("input",{type:"text",name:"pancard_number",value:d.pancard_number,onChange:o,className:"mt-1 block w-full border border-gray-300 rounded-md p-2",placeholder:"Enter Value"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Aadhaarcard Number"}),e.jsx("input",{type:"text",name:"aadhaar_number",value:d.aadhaar_number,onChange:o,className:"mt-1 block w-full border border-gray-300 rounded-md p-2",placeholder:"Enter Value"})]})]}),e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Personal Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Mobile"}),e.jsx("input",{type:"text",name:"mobile",value:d.mobile,onChange:o,className:"mt-1 block w-full border border-gray-300 rounded-md p-2",placeholder:"Enter Value"})]}),e.jsxs("div",{className:"md:col-span-3",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Address"}),e.jsx("input",{type:"text",name:"address",value:d.address,onChange:o,className:"mt-1 block w-full border border-gray-300 rounded-md p-2",placeholder:"Enter Value"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"State"}),e.jsx("input",{type:"text",name:"state",value:d.state,onChange:o,className:"mt-1 block w-full border border-gray-300 rounded-md p-2",placeholder:"Enter Value"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"City"}),e.jsx("input",{type:"text",name:"city",value:d.city,onChange:o,className:"mt-1 block w-full border border-gray-300 rounded-md p-2",placeholder:"Enter Value"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Pincode"}),e.jsx("input",{type:"text",name:"pincode",value:d.pincode,onChange:o,className:"mt-1 block w-full border border-gray-300 rounded-md p-2",placeholder:"Enter Value"})]})]}),e.jsxs("div",{className:"flex justify-end gap-4",children:[e.jsx("button",{onClick:()=>w(!1),className:"px-4 py-2 bg-gray-600 text-white rounded",children:"Cancel"}),e.jsx("button",{onClick:q,className:"px-4 py-2 bg-blue-600 text-white rounded",children:"Submit"})]}),R&&e.jsxs("div",{className:"mt-4 p-4 bg-green-100 text-green-700 rounded",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Generated Password:"})," ",R]}),e.jsx("p",{children:"Please save this password securely. It will be needed for login."}),e.jsx("p",{children:"An email with the credentials has been sent to the user."})]}),M&&e.jsx("div",{className:"mt-4 p-4 bg-red-100 text-red-700 rounded",children:e.jsxs("p",{children:[e.jsx("strong",{children:"Error:"})," ",M]})})]})]}):e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Home - Member Details"}),e.jsx("div",{className:"bg-gray-200 p-2 rounded-t-lg",children:N.map(a=>e.jsx("button",{onClick:()=>$(a),className:`px-4 py-2 mr-2 rounded-t-lg ${n===a?"bg-yellow-500 text-white":"bg-gray-300"}`,children:a.charAt(0).toUpperCase()+a.slice(1)},a))}),e.jsx("div",{className:"bg-gray-200 p-4 rounded-b-lg",children:e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"date",value:x,onChange:a=>A(a.target.value),className:"p-2 border rounded"}),e.jsx("input",{type:"date",value:h,onChange:a=>_(a.target.value),className:"p-2 border rounded"}),e.jsx("input",{type:"text",value:m,onChange:a=>S(a.target.value),placeholder:"Search Value",className:"p-2 border rounded"}),e.jsx("input",{type:"text",placeholder:"Agent ID / Parent ID",className:"p-2 border rounded"}),e.jsxs("select",{className:"p-2 border rounded",children:[e.jsx("option",{value:"",children:"Select Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"deactive",children:"Deactive"})]}),e.jsxs("select",{value:u,onChange:a=>E(a.target.value),className:"p-2 border rounded",children:[e.jsx("option",{value:"",children:"Select Company"}),e.jsx("option",{value:"Banking NIKAT-By",children:"Banking NIKAT-By"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:B,className:"p-2 bg-gray-600 text-white rounded",children:e.jsx(O,{className:"h-4 w-4"})}),e.jsx("button",{onClick:K,className:"p-2 bg-red-600 text-white rounded",children:e.jsx(W,{className:"h-4 w-4"})}),e.jsx("button",{onClick:U,className:"p-2 bg-blue-600 text-white rounded",children:e.jsx(Y,{className:"h-4 w-4"})})]})]})}),e.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-md mt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-lg font-semibold",children:[n.charAt(0).toUpperCase()+n.slice(1)," List"]}),e.jsx("button",{onClick:()=>w(!0),className:"px-4 py-2 bg-blue-600 text-white rounded",children:"+ Add User"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"#"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Company Profile"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Action"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:j.length>0?j.map((a,s)=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s+1}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[a.name,e.jsx("br",{}),a.email,e.jsx("br",{}),a.created_at]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:a.company||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.jsxs("select",{className:"border border-gray-300 rounded-md p-1",onChange:t=>{t.target.value!=="action"&&t.target.value==="delete"&&n!=="deactivated"&&H(a.id)},children:[e.jsx("option",{value:"action",children:"Action"}),n!=="deactivated"&&e.jsx("option",{value:"delete",children:"Deactivate"}),e.jsx("option",{value:"reports",children:"Reports"})]})})]},a.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"px-6 py-4 text-center text-sm text-gray-500",children:"No Data Available in Table"})})})]})}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("p",{className:"text-sm text-gray-500",children:["Showing ",j.length," to 0 of ",j.length," entries"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"px-3 py-1 bg-gray-200 rounded",children:"Previous"}),e.jsx("span",{className:"px-3 py-1 bg-blue-600 text-white rounded",children:"1"}),e.jsx("button",{className:"px-3 py-1 bg-gray-200 rounded",children:"Next"}),e.jsxs("select",{className:"p-1 border rounded",children:[e.jsx("option",{children:"Show 10"}),e.jsx("option",{children:"Show 25"}),e.jsx("option",{children:"Show 50"})]})]})]})]})]})};export{te as default};
