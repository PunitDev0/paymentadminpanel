import{j as e,r as l,m as ae,a0 as le,w as R}from"./app-DE-wH-X1.js";import{u as ne,q as ie,D as V,m as k,n as I,o as Z,p as O,F as oe,a as w,b as y,c as C,d as ce,e as S,f as L,g as de,h as xe,i as me,y as f}from"./index-DnHNNK40.js";import{C as ue,c as he}from"./card-CYliUdp8.js";import{T as ge,a as fe,b as D,c as g,d as pe,e as u}from"./table-Bzk4kHtu.js";import{c as H,B as j}from"./button-C6ACBVtC.js";import{c as v}from"./utils-CiMRq3MP.js";import{S as M,a as _,b as q,c as $,d as U}from"./select-usd-MRt1.js";import{I as A}from"./input-BEW3Mj_D.js";import{S as je}from"./switch-D5KGVnIh.js";import"./index-o7PBo7jg.js";import"./index-DjB1QeRK.js";import"./clsx-B-dksMZM.js";import"./index-CFrhXeOp.js";import"./check-BnNeWyEE.js";const ve=H("inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground shadow hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground shadow hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function be({className:t,variant:n,...a}){return e.jsx("div",{className:v(ve({variant:n}),t),...a})}function Ne({className:t,...n}){return e.jsx("div",{className:v("animate-pulse rounded-md bg-primary/10",t),...n})}function z(t,n){if(t==null)return{};var a={},o=Object.keys(t),c,x;for(x=0;x<o.length;x++)c=o[x],!(n.indexOf(c)>=0)&&(a[c]=t[c]);return a}var we=["color"],B=l.forwardRef(function(t,n){var a=t.color,o=a===void 0?"currentColor":a,c=z(t,we);return l.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},c,{ref:n}),l.createElement("path",{d:"M7.28856 0.796908C7.42258 0.734364 7.57742 0.734364 7.71144 0.796908L13.7114 3.59691C13.8875 3.67906 14 3.85574 14 4.05V10.95C14 11.1443 13.8875 11.3209 13.7114 11.4031L7.71144 14.2031C7.57742 14.2656 7.42258 14.2656 7.28856 14.2031L1.28856 11.4031C1.11252 11.3209 1 11.1443 1 10.95V4.05C1 3.85574 1.11252 3.67906 1.28856 3.59691L7.28856 0.796908ZM2 4.80578L7 6.93078V12.9649L2 10.6316V4.80578ZM8 12.9649L13 10.6316V4.80578L8 6.93078V12.9649ZM7.5 6.05672L12.2719 4.02866L7.5 1.80176L2.72809 4.02866L7.5 6.05672Z",fill:o,fillRule:"evenodd",clipRule:"evenodd"}))}),ye=["color"],Ce=l.forwardRef(function(t,n){var a=t.color,o=a===void 0?"currentColor":a,c=z(t,ye);return l.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},c,{ref:n}),l.createElement("path",{d:"M8.4449 0.608765C8.0183 -0.107015 6.9817 -0.107015 6.55509 0.608766L0.161178 11.3368C-0.275824 12.07 0.252503 13 1.10608 13H13.8939C14.7475 13 15.2758 12.07 14.8388 11.3368L8.4449 0.608765ZM7.4141 1.12073C7.45288 1.05566 7.54712 1.05566 7.5859 1.12073L13.9798 11.8488C14.0196 11.9154 13.9715 12 13.8939 12H1.10608C1.02849 12 0.980454 11.9154 1.02018 11.8488L7.4141 1.12073ZM6.8269 4.48611C6.81221 4.10423 7.11783 3.78663 7.5 3.78663C7.88217 3.78663 8.18778 4.10423 8.1731 4.48612L8.01921 8.48701C8.00848 8.766 7.7792 8.98664 7.5 8.98664C7.2208 8.98664 6.99151 8.766 6.98078 8.48701L6.8269 4.48611ZM8.24989 10.476C8.24989 10.8902 7.9141 11.226 7.49989 11.226C7.08567 11.226 6.74989 10.8902 6.74989 10.476C6.74989 10.0618 7.08567 9.72599 7.49989 9.72599C7.9141 9.72599 8.24989 10.0618 8.24989 10.476Z",fill:o,fillRule:"evenodd",clipRule:"evenodd"}))});const Se=H("relative w-full rounded-lg border px-4 py-3 text-sm [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground [&>svg~*]:pl-7",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),P=l.forwardRef(({className:t,variant:n,...a},o)=>e.jsx("div",{ref:o,role:"alert",className:v(Se({variant:n}),t),...a}));P.displayName="Alert";const Le=l.forwardRef(({className:t,...n},a)=>e.jsx("h5",{ref:a,className:v("mb-1 font-medium leading-none tracking-tight",t),...n}));Le.displayName="AlertTitle";const K=l.forwardRef(({className:t,...n},a)=>e.jsx("div",{ref:a,className:v("text-sm [&_p]:leading-relaxed",t),...n}));K.displayName="AlertDescription";function Ae({setActiveSection:t,setUserData:n}){const[a,o]=l.useState([]),[c,x]=l.useState(!0),[F,W]=l.useState(null),[m,h]=l.useState(null),[G,b]=l.useState(!1),[J,N]=l.useState(!1),[Q]=l.useState(["admin","user"]),[E,X]=l.useState(""),d=ne({defaultValues:{name:"",email:"",role:"",password:""},mode:"onChange"});l.useEffect(()=>{let s=!0;return(async()=>{try{const i=await ae();s&&(o((i==null?void 0:i.users)||[]),x(!1))}catch(i){s&&(W(i.message||"Failed to fetch users"),x(!1))}})(),()=>{s=!1}},[]);const T=a.filter(s=>{var r,i;return((r=s.name)==null?void 0:r.toLowerCase().includes(E.toLowerCase()))||((i=s.email)==null?void 0:i.toLowerCase().includes(E.toLowerCase()))}),Y=(s,r)=>{s==="edit"?(h(r),d.reset({name:r.name||"",email:r.email||"",role:r.role||"",password:""}),N(!0)):s==="delete"&&(h(r),b(!0))},ee=async()=>{if(m)try{await le(m.id),o(a.filter(s=>s.id!==m.id)),f.success("User deleted successfully!")}catch(s){f.error("Failed to delete user. Try again!"),console.error("Delete error:",s)}finally{b(!1),h(null)}},se=async s=>{try{const r={...s,status:s.status===1?0:1},i=await R(s.id,r);o(a.map(p=>p.id===s.id?i.user:p)),f.success(`User ${r.status===1?"activated":"deactivated"} successfully!`)}catch(r){f.error("Failed to update user status. Try again!"),console.error("Error updating user status:",r)}},re=async s=>{if(m){x(!0);try{const r={...s};r.password||delete r.password;const i=await R(m.id,r);o(a.map(p=>p.id===m.id?i.user:p)),f.success("User updated successfully!"),N(!1),h(null),d.reset()}catch(r){f.error(r.message||"Failed to update user"),console.error("Error updating user:",r)}finally{x(!1)}}},te=s=>{X(s.target.value)};return e.jsxs("div",{className:"p-6 min-h-screen",children:[e.jsx("div",{children:e.jsxs("h2",{className:"text-3xl font-bold flex items-center gap-2 text-indigo-800",children:[e.jsx(B,{className:"h-8 w-8 text-indigo-600"})," All Users"]})}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4 max-w-lg border p-2 mt-4 mx-4 rounded-md bg-white shadow-sm",children:[e.jsx(ie,{className:"text-gray-400"}),e.jsx(A,{placeholder:"Search users by name or email...",value:E,onChange:te,className:"border-none focus:ring-0"})]}),e.jsx("div",{className:"flex gap-4",children:e.jsx(j,{onClick:()=>t("add-user"),className:"bg-green-500 text-white hover:bg-green-600",children:"Add New"})})]}),e.jsx(ue,{className:"w-full shadow-lg rounded-xl bg-white overflow-hidden",children:e.jsx(he,{className:"p-5",children:e.jsx("div",{className:"p-6",children:F?e.jsxs(P,{variant:"destructive",className:"mb-6 bg-red-100 border border-red-400",children:[e.jsx(Ce,{className:"h-4 w-4 text-red-500"}),e.jsxs(K,{className:"text-red-700",children:["Error: ",F]})]}):c?e.jsx("div",{className:"space-y-4",children:[...Array(5)].map((s,r)=>e.jsx(Ne,{className:"h-12 w-full rounded-lg bg-gray-200"},r))}):e.jsx("div",{className:"border rounded-lg overflow-auto shadow-lg",children:e.jsxs(ge,{className:"w-full min-w-[600px]",children:[e.jsx(fe,{className:"bg-indigo-100",children:e.jsxs(D,{children:[e.jsx(g,{className:"text-center text-indigo-800",children:"ID"}),e.jsx(g,{className:"text-center text-indigo-800",children:"Name"}),e.jsx(g,{className:"text-center text-indigo-800",children:"Email"}),e.jsx(g,{className:"text-center text-indigo-800",children:"Role"}),e.jsx(g,{className:"text-center text-indigo-800",children:"Created At"}),e.jsx(g,{className:"text-center text-indigo-800",children:"Status"}),e.jsx(g,{className:"text-center text-indigo-800",children:"Actions"})]})}),e.jsx(pe,{children:T.length>0?T.map(s=>e.jsxs(D,{className:"hover:bg-indigo-50 border-t",children:[e.jsx(u,{className:"text-center py-4",children:s.id}),e.jsx(u,{className:"text-center",children:e.jsx(be,{variant:"outline",className:"text-indigo-600",children:s.name||"N/A"})}),e.jsx(u,{className:"text-center",children:s.email||"N/A"}),e.jsx(u,{className:"text-center font-mono text-gray-600",children:s.role||"N/A"}),e.jsx(u,{className:"text-center text-sm text-gray-500",children:s.created_at?new Date(s.created_at).toLocaleString():"N/A"}),e.jsx(u,{className:"text-center",children:e.jsx(je,{checked:s.status===1,onCheckedChange:()=>se(s),className:`${s.status==="1"?"bg-green-600":"bg-red-600"} rounded-full`})}),e.jsx(u,{className:"text-center",children:e.jsxs(M,{onValueChange:r=>Y(r,s),children:[e.jsx(_,{className:"w-24 border rounded-md bg-indigo-50 text-indigo-700 mx-auto",children:e.jsx(q,{placeholder:"Actions"})}),e.jsxs($,{children:[e.jsx(U,{value:"edit",children:"Edit"}),e.jsx(U,{value:"delete",children:"Delete"})]})]})})]},s.id)):e.jsx(D,{children:e.jsxs(u,{colSpan:"7",className:"h-24 text-center text-gray-500",children:[e.jsx(B,{className:"h-8 w-8 text-gray-400 mx-auto"}),"No users found"]})})})]})})})})}),e.jsx(V,{open:G,onOpenChange:b,children:e.jsxs(k,{children:[e.jsx(I,{children:e.jsx(Z,{children:"Confirm Deletion"})}),e.jsxs("p",{children:["Are you sure you want to delete the user ",(m==null?void 0:m.name)||"this user","?"]}),e.jsxs(O,{children:[e.jsx(j,{variant:"outline",onClick:()=>{b(!1),h(null)},children:"Cancel"}),e.jsx(j,{className:"bg-red-600 text-white hover:bg-red-700",onClick:ee,children:"Delete"})]})]})}),e.jsx(V,{open:J,onOpenChange:s=>{N(s),s||(h(null),d.reset())},children:e.jsxs(k,{children:[e.jsx(I,{children:e.jsx(Z,{children:"Edit User"})}),e.jsx(oe,{...d,children:e.jsxs("form",{onSubmit:d.handleSubmit(re),className:"space-y-6",children:[e.jsx(w,{control:d.control,name:"name",rules:{required:"Name is required"},render:({field:s})=>e.jsxs(y,{className:"flex items-center space-x-3",children:[e.jsxs(C,{className:"flex items-center text-gray-600",children:[e.jsx(ce,{className:"mr-2 text-blue-500"})," Name"]}),e.jsx(S,{children:e.jsx(A,{...s,placeholder:"Enter name"})}),e.jsx(L,{})]})}),e.jsx(w,{control:d.control,name:"email",rules:{required:"Email is required",pattern:{value:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,message:"Invalid email address"}},render:({field:s})=>e.jsxs(y,{className:"flex items-center space-x-3",children:[e.jsxs(C,{className:"flex items-center text-gray-600",children:[e.jsx(de,{className:"mr-2 text-blue-500"})," Email"]}),e.jsx(S,{children:e.jsx(A,{...s,type:"email",placeholder:"Enter email"})}),e.jsx(L,{})]})}),e.jsx(w,{control:d.control,name:"role",rules:{required:"Role is required"},render:({field:s})=>e.jsxs(y,{className:"flex items-center space-x-3",children:[e.jsxs(C,{className:"flex items-center text-gray-600",children:[e.jsx(xe,{className:"mr-2 text-blue-500"})," Role"]}),e.jsxs(M,{onValueChange:s.onChange,value:s.value,children:[e.jsx(S,{children:e.jsx(_,{children:e.jsx(q,{placeholder:"Select a role"})})}),e.jsx($,{children:Q.map((r,i)=>e.jsx(U,{value:r,children:r.charAt(0).toUpperCase()+r.slice(1)},i))})]}),e.jsx(L,{})]})}),e.jsx(w,{control:d.control,name:"password",rules:{minLength:{value:6,message:"Password must be at least 6 characters long"}},render:({field:s})=>e.jsxs(y,{className:"flex items-center space-x-3",children:[e.jsxs(C,{className:"flex items-center text-gray-600",children:[e.jsx(me,{className:"mr-2 text-blue-500"})," Password"]}),e.jsx(S,{children:e.jsx(A,{...s,type:"password",placeholder:"Enter new password (optional)"})}),e.jsx(L,{})]})}),e.jsxs(O,{children:[e.jsx(j,{variant:"outline",onClick:()=>{N(!1),h(null),d.reset()},children:"Cancel"}),e.jsx(j,{type:"submit",className:"bg-[#7C3AED] hover:bg-[#6D28D9]",disabled:c,children:c?"Updating...":"Update User"})]})]})})]})})]})}function $e(){return e.jsx("div",{children:e.jsx(Ae,{})})}export{$e as default};
